(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{phNo:function(t,e,i){"use strict";i.r(e),i.d(e,"LoginModule",(function(){return j}));var o=i("ofXK"),n=i("tyNb"),r=i("mrSG"),s=i("3Pt+"),a=i("JIvj"),c=i("GHWL"),l=i("fXoL");class d{constructor(t){this.academusoftId=null!=t?t.academusoftId:"",this.age=null!=t?t.age:0,this.campusId=null!=t?t.campusId:0,this.cellPhone=null!=t?t.cellPhone:"",this.document=null!=t?t.document:"",this.documentType=null!=t?t.documentType:"",this.estamentId=null!=t?t.estamentId:0,this.stateId=null!=t?t.stateId:0,this.facultyId=null!=t?t.facultyId:0,this.gender=null!=t?t.gender:"",this.id=null!=t?t.id:0,this.jornalyId=null!=t?t.jornalyId:0,this.lastName=null!=t?t.lastName:"",this.login=null!=t?t.login:"",this.mail=null!=t?t.mail:"",this.name=null!=t?t.name:"",this.password=null!=t?t.password:"",this.programId=null!=t?t.programId:"",this.rolId=null!=t?t.rolId:0,this.semester=null!=t?t.semester:0,this.tokenAcademusoft=null!=t?t.tokenAcademusoft:""}}var u=i("tk/3");let b=(()=>{class t{constructor(t){this._http=t,this.users=new d(this.users)}validateUser(t){return Object(r.a)(this,void 0,void 0,(function*(){try{this.users.login=t;const e=`${c.a.API_ENDPOINT}${c.a.USERS_ENDPOINT}${c.a.VALIDATE_USER_ENDPOINT}`,i=yield fetch(e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(this.users)});return yield i.json()}catch(e){console.log(e)}}))}authenticateUser(t,e){return Object(r.a)(this,void 0,void 0,(function*(){try{this.users.login=t,this.users.password=e;const i=`${c.a.API_ENDPOINT}${c.a.USERS_ENDPOINT}${c.a.AUTHENTICATE_USER_ENDPOINT}`,o=yield fetch(i,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(this.users)});return yield o.json()}catch(i){console.log(i)}}))}recoverPassword(t){return Object(r.a)(this,void 0,void 0,(function*(){try{this.users.login=t;const e=`${c.a.API_ENDPOINT}${c.a.USERS_ENDPOINT}${c.a.RECOVERYPASSWORD_USER_ENDPOINT}`,i=yield fetch(e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(this.users)});return yield i.json()}catch(e){console.log(e)}}))}}return t.\u0275fac=function(e){return new(e||t)(l.Yb(u.a))},t.\u0275prov=l.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var m=i("0IaG"),h=i("mnw+"),f=i("7lrx"),v=i("Sy1n"),p=i("kmnG"),g=i("qFsG"),y=i("bTqV"),T=i("NFeN"),N=i("Xa2L");function C(t,e){if(1&t){const t=l.Vb();l.Ub(0,"button",20),l.cc("click",(function(){return l.mc(t),l.fc(2).LoginForm.controls.userName.setValue("")})),l.Ub(1,"mat-icon"),l.tc(2,"close"),l.Tb(),l.Tb()}}function U(t,e){if(1&t&&(l.Ub(0,"div"),l.tc(1),l.Tb()),2&t){const t=l.fc(3);l.Cb(1),l.vc(" ",t.validateUserName," ")}}function I(t,e){if(1&t&&(l.Ub(0,"div",21),l.sc(1,U,2,1,"div",22),l.Tb()),2&t){const t=l.fc(2);l.Cb(1),l.ic("ngIf",t.LoginForm.controls.userName.errors.required||t.LoginForm.controls.userName.status)}}function R(t,e){if(1&t){const t=l.Vb();l.Ub(0,"form",12),l.Ub(1,"mat-form-field",13),l.Ub(2,"span",14),l.Pb(3,"img",15),l.Tb(),l.Pb(4,"input",16),l.sc(5,C,3,0,"button",17),l.Tb(),l.sc(6,I,2,1,"div",18),l.Pb(7,"br"),l.Ub(8,"button",19),l.cc("click",(function(){return l.mc(t),l.fc().onSubmit()})),l.tc(9),l.Tb(),l.Tb()}if(2&t){const t=l.fc();l.ic("formGroup",t.LoginForm),l.Cb(4),l.jc("placeholder",t.txtUser),l.Cb(1),l.ic("ngIf",t.LoginForm.value.userName),l.Cb(1),l.ic("ngIf",t.LoginForm.controls.userName.invalid&&(t.LoginForm.controls.userName.dirty||t.LoginForm.controls.userName.touched)),l.Cb(3),l.uc(t.buttonLogin)}}function w(t,e){if(1&t&&(l.Ub(0,"div"),l.tc(1),l.Tb()),2&t){const t=l.fc(3);l.Cb(1),l.vc(" ",t.validatePassword," ")}}function O(t,e){if(1&t&&(l.Ub(0,"div",21),l.sc(1,w,2,1,"div",22),l.Tb()),2&t){const t=l.fc(2);l.Cb(1),l.ic("ngIf",t.LoginForm.controls.password.errors.required||t.LoginForm.controls.password.status)}}function S(t,e){if(1&t){const t=l.Vb();l.Ub(0,"form",12),l.Ub(1,"mat-form-field",13),l.Ub(2,"span",14),l.Pb(3,"img",23),l.Tb(),l.Pb(4,"input",24),l.Ub(5,"button",25),l.cc("click",(function(){l.mc(t);const e=l.fc();return e.hide=!e.hide})),l.Ub(6,"mat-icon"),l.tc(7),l.Tb(),l.Tb(),l.Tb(),l.sc(8,O,2,1,"div",18),l.Pb(9,"br"),l.Ub(10,"div",26),l.Ub(11,"button",27),l.cc("click",(function(){return l.mc(t),l.fc().onReturn()})),l.tc(12),l.Tb(),l.Ub(13,"button",28),l.cc("click",(function(){return l.mc(t),l.fc().onSubmitAuthenticate()})),l.tc(14),l.Tb(),l.Tb(),l.Pb(15,"br"),l.Ub(16,"div",29),l.Ub(17,"a",30),l.cc("click",(function(){return l.mc(t),l.fc().showRecovery()})),l.tc(18),l.Tb(),l.Tb(),l.Tb()}if(2&t){const t=l.fc();l.ic("formGroup",t.LoginForm),l.Cb(4),l.jc("placeholder",t.txtPassword),l.ic("type",t.hide?"password":"text"),l.Cb(1),l.Db("aria-label","Hide password")("aria-pressed",t.hide),l.Cb(2),l.uc(t.hide?"visibility_off":"visibility"),l.Cb(1),l.ic("ngIf",t.LoginForm.controls.password.invalid&&(t.LoginForm.controls.password.dirty||t.LoginForm.controls.password.touched)),l.Cb(4),l.uc(t.buttonCancel),l.Cb(2),l.uc(t.buttonPassword),l.Cb(4),l.uc(t.txtRecovery)}}function P(t,e){if(1&t){const t=l.Vb();l.Ub(0,"button",20),l.cc("click",(function(){return l.mc(t),l.fc(2).LoginForm.controls.userNameRecovery.setValue("")})),l.Ub(1,"mat-icon"),l.tc(2,"close"),l.Tb(),l.Tb()}}function L(t,e){if(1&t&&(l.Ub(0,"div"),l.tc(1),l.Tb()),2&t){const t=l.fc(3);l.Cb(1),l.vc(" ",t.validateUserName," ")}}function _(t,e){if(1&t&&(l.Ub(0,"div",21),l.sc(1,L,2,1,"div",22),l.Tb()),2&t){const t=l.fc(2);l.Cb(1),l.ic("ngIf",t.LoginForm.controls.userNameRecovery.errors.required||t.LoginForm.controls.userNameRecovery.status)}}function x(t,e){if(1&t){const t=l.Vb();l.Ub(0,"form",12),l.Ub(1,"mat-form-field",13),l.Ub(2,"span",14),l.Pb(3,"img",15),l.Tb(),l.Pb(4,"input",31),l.sc(5,P,3,0,"button",17),l.Tb(),l.sc(6,_,2,1,"div",18),l.Pb(7,"br"),l.Ub(8,"button",19),l.cc("click",(function(){return l.mc(t),l.fc().onRecoveryPassword()})),l.tc(9),l.Tb(),l.Ub(10,"div",32),l.Ub(11,"a",30),l.cc("click",(function(){return l.mc(t),l.fc().onReturn()})),l.tc(12),l.Tb(),l.Tb(),l.Tb()}if(2&t){const t=l.fc();l.ic("formGroup",t.LoginForm),l.Cb(5),l.ic("ngIf",t.LoginForm.value.userNameRecovery),l.Cb(1),l.ic("ngIf",t.LoginForm.controls.userNameRecovery.invalid&&(t.LoginForm.controls.userNameRecovery.dirty||t.LoginForm.controls.userNameRecovery.touched)),l.Cb(3),l.uc(t.buttonRecovery),l.Cb(3),l.uc(t.txtCancelRecovery)}}function A(t,e){1&t&&(l.Ub(0,"div",33),l.Ub(1,"div",34),l.Pb(2,"mat-spinner",35),l.Tb(),l.Tb())}let F=(()=>{class t{constructor(t,e,i,o,n,r){this._loginService=t,this.router=e,this._matDialog=i,this._dialogService=o,this._cacheService=n,this._appComponent=r,this.txtBienvenido=c.a.TXTLOGOUNIAJCBIENVENIDO,this.txtUniajc=c.a.TXTLOGOUNIAJC,this.validateUserName=c.a.VALIDATE_USERNAME,this.validatePassword=c.a.VALIDATE_PASSWORD,this.buttonLogin=c.a.BUTTON_LOGIN,this.buttonCancel=c.a.BUTTON_CANCEL,this.buttonPassword=c.a.BUTTON_PASSWORD,this.buttonRecovery=c.a.BUTTON_RECOVERY,this.txtUser=c.a.TXTUSER,this.txtPassword=c.a.TXTPASSWORD,this.txtRecovery=c.a.TXTRECOVERY,this.txtCancelRecovery=c.a.CANCEL_RECOVERY,this.LoginForm=new s.d({userName:new s.b(""),password:new s.b(""),userNameRecovery:new s.b("")}),this.blValidate=!0,this.blRecovery=!0,this.hide=!0,this.blSpinner=!1,r.blMenu=!1}ngOnInit(){}onSubmit(){""!=this.LoginForm.value.userName&&this.validateUser()}onSubmitAuthenticate(){""!=this.LoginForm.value.password&&""!=this.LoginForm.value.userName&&this.authenticateUser()}onRecoveryPassword(){""!=this.LoginForm.value.userNameRecovery&&this.recoveryPassword()}onReturn(){this.blValidate=!0,this.blRecovery=!0,this.LoginForm.controls.userName.setValue(""),this.LoginForm.controls.userNameRecovery.setValue(""),this.LoginForm.controls.password.setValue("")}showRecovery(){this.blRecovery=!1,this.LoginForm.controls.userName.setValue(""),this.LoginForm.controls.password.setValue(""),this.LoginForm.controls.userNameRecovery.setValue("")}openDialog(t,e){this._matDialog.open(a.a),this._dialogService.dialog.title=e,this._dialogService.dialog.content=t}validateUser(){return Object(r.a)(this,void 0,void 0,(function*(){this.blSpinner=!0;let t=yield this._loginService.validateUser(this.LoginForm.value.userName);t.result?this.blValidate=!1:this.openDialog(t.msg,"Advertencia"),this.blSpinner=!1}))}authenticateUser(){return Object(r.a)(this,void 0,void 0,(function*(){this.blSpinner=!0;let t=yield this._loginService.authenticateUser(this.LoginForm.value.userName,this.LoginForm.value.password);t.result?t.data.rolId==c.a.ROLADMIN||t.data.rolId==c.a.ROLSTATISTICS?(this.user=t.data,this._cacheService.save({key:"userId",data:t.data.id,expirationMins:360}),this._cacheService.save({key:"rolId",data:t.data.rolId,expirationMins:360}),this._cacheService.save({key:"user",data:this.user,expirationMins:360}),this._cacheService.save({key:"token",data:t.token,expirationMins:360}),this._cacheService.save({key:"tokenAcademusoft",data:t.data.tokenAcademusoft,expirationMins:360}),this._cacheService.save({key:"academusoftId",data:t.data.academusoftId,expirationMins:360}),this._appComponent.blMenu=!0,t.data.rolId==c.a.ROLADMIN?(this._appComponent.blAdmin=!0,this.router.navigateByUrl("/events")):this.router.navigateByUrl("/statistics")):(this.blValidate=!0,this.blRecovery=!0,this.openDialog(c.a.AUTHENTICATE_USER_ROLNOTFOUND,"Advertencia")):this.openDialog(t.msg,"Advertencia"),this.blSpinner=!1}))}recoveryPassword(){return Object(r.a)(this,void 0,void 0,(function*(){this.blSpinner=!0;let t=yield this._loginService.recoverPassword(this.LoginForm.value.userNameRecovery);t.result?(this.blValidate=!0,this.blRecovery=!0,this.openDialog(t.msg,"Exito")):this.openDialog(t.msg,"Advertencia"),this.blSpinner=!1}))}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(b),l.Ob(n.a),l.Ob(m.a),l.Ob(h.a),l.Ob(f.a),l.Ob(v.a))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-login"]],decls:16,vars:6,consts:[[1,"main-div"],[1,"divCointainerMain"],[2,"width","100%","margin-bottom","10%"],["src","assets/logo-enterate.png","width","90%"],[1,"container",2,"margin-bottom","10%"],[1,"logoContainer"],["src","assets/logo-camacho-gris.png","width","40px"],[1,"txtContainer"],[1,"clsTxtLogoBienvenido"],[1,"clsTxtLogoUniCamacho"],[3,"formGroup",4,"ngIf"],["class","overlay",4,"ngIf"],[3,"formGroup"],[1,"example-form-field",2,"width","100%"],["matPrefix","",2,"margin-right","5%"],["src","assets/icono-usuario.png","width","25px"],["matInput","","type","text","formControlName","userName","id","userName","name","userName","required","",3,"placeholder"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["mat-raised-button","",1,"SmartButtonAzul",2,"width","100%","margin-top","10%",3,"click"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"],["src","assets/icono-password.png","width","25px"],["matInput","","formControlName","password","id","password","name","password",3,"type","placeholder"],["mat-icon-button","","matSuffix","",3,"click"],[1,"buttonsAuthenticate"],["mat-raised-button","",1,"SmartButtonWhite",2,"width","40%","margin-top","10%","margin-right","5%",3,"click"],["mat-raised-button","",1,"SmartButtonAzul",2,"width","40%","margin-top","10%",3,"click"],[1,"divRecovery"],["href","javascript:",3,"click"],["matInput","","type","text","formControlName","userNameRecovery","id","userNameRecovery","name","userNameRecovery","required","","placeholder","usuario"],[1,"divRecovery",2,"padding-top","4%"],[1,"overlay"],[1,"center"],["diameter","70"]],template:function(t,e){1&t&&(l.Ub(0,"div",0),l.Ub(1,"div",1),l.Ub(2,"div",2),l.Pb(3,"img",3),l.Tb(),l.Ub(4,"div",4),l.Ub(5,"div",5),l.Pb(6,"img",6),l.Tb(),l.Ub(7,"div",7),l.Ub(8,"p",8),l.tc(9),l.Tb(),l.Ub(10,"p",9),l.tc(11),l.Tb(),l.Tb(),l.Tb(),l.sc(12,R,10,5,"form",10),l.sc(13,S,19,10,"form",10),l.sc(14,x,13,5,"form",10),l.sc(15,A,3,0,"div",11),l.Tb(),l.Tb()),2&t&&(l.Cb(9),l.uc(e.txtBienvenido),l.Cb(2),l.uc(e.txtUniajc),l.Cb(1),l.ic("ngIf",e.blValidate&&e.blRecovery),l.Cb(1),l.ic("ngIf",!e.blValidate&&e.blRecovery),l.Cb(1),l.ic("ngIf",!e.blRecovery),l.Cb(1),l.ic("ngIf",e.blSpinner))},directives:[o.j,s.q,s.l,s.e,p.b,p.f,g.b,s.a,s.k,s.c,s.o,y.b,p.g,T.a,N.b],styles:[".example-form-field[_ngcontent-%COMP%]{width:200px}.divCointainerMain[_ngcontent-%COMP%]{padding-top:4%;width:30%;border-radius:5px}.main-div[_ngcontent-%COMP%]{flex-direction:row}.divRecovery[_ngcontent-%COMP%], .main-div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.divRecovery[_ngcontent-%COMP%]{flex-direction:column}.clsTxtLogoBienvenido[_ngcontent-%COMP%]{font-family:Raleway Medium;font-size:30px!important;color:#006cd2}.clsTxtLogoUniCamacho[_ngcontent-%COMP%]{font-family:Raleway Medium;font-size:16px!important;color:#626262}.container[_ngcontent-%COMP%], .divGrap[_ngcontent-%COMP%]{display:flex;flex-direction:row}.divGrap[_ngcontent-%COMP%]{width:100%;margin-top:4%;justify-content:center;align-items:center}.txtContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;padding-left:1%}.buttonsAuthenticate[_ngcontent-%COMP%]{justify-content:center;align-items:center;display:flex;flex-direction:row}.imgSmartCampus[_ngcontent-%COMP%]{width:100%;margin-top:20%}"]}),t})();var E=i("Wp6s"),k=i("zkoq");const M=[{path:"",component:F}];let j=(()=>{class t{}return t.\u0275mod=l.Mb({type:t}),t.\u0275inj=l.Lb({factory:function(e){return new(e||t)},imports:[[o.b,n.c.forChild(M),s.n,s.f,g.c,T.b,y.c,E.b,k.b,m.d,N.a]]}),t})()}}]);